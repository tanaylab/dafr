<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data in Axes in Formats • dafr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Data in Axes in Formats">
<meta name="description" content="An R interface to DataAxesFormats.jl &lt;https://github.com/tanaylab/DataAxesFormats.jl&gt;, a Julia package providing a uniform interface for accessing multi-dimensional data arranged along arbitrary axes. This package generalizes and extends AnnData-like functionality, supporting both 1D and 2D data, multiple data modalities, and efficient memory management. dafr enables R users to create, read, modify, and analyze complex biological datasets such as single-cell data with multiple modalities (RNA-seq, ATAC-seq, etc.). The package implements efficient memory management strategies and provides a seamless interface between R and Julia for handling large-scale biological data.">
<meta property="og:description" content="An R interface to DataAxesFormats.jl &lt;https://github.com/tanaylab/DataAxesFormats.jl&gt;, a Julia package providing a uniform interface for accessing multi-dimensional data arranged along arbitrary axes. This package generalizes and extends AnnData-like functionality, supporting both 1D and 2D data, multiple data modalities, and efficient memory management. dafr enables R users to create, read, modify, and analyze complex biological datasets such as single-cell data with multiple modalities (RNA-seq, ATAC-seq, etc.). The package implements efficient memory management strategies and provides a seamless interface between R and Julia for handling large-scale biological data.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">dafr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tanaylab/dafr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="dafr---data-in-axes-in-formats-for-r">dafr - Data in Axes in Formats for R<a class="anchor" aria-label="anchor" href="#dafr---data-in-axes-in-formats-for-r"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of dafr is to provide R bindings for the <a href="https://github.com/tanaylab/DataAxesFormats.jl" class="external-link">DataAxesFormats.jl</a> Julia package, which provides a uniform generic interface for accessing 1D and 2D data arranged along some set of axes. This is a much-needed generalization of the <a href="https://github.com/scverse/anndata" class="external-link">AnnData</a> functionality.</p>
<p>The dafr package enables R users to access <code>Daf</code> data using familiar R interfaces while leveraging the powerful implementation provided by the Julia package. The package follows a functional interface similar to the Julia implementation.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of dafr from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tanaylab/dafr"</span><span class="op">)</span></span></code></pre></div>
<p>Note that dafr requires the Julia programming language and the DataAxesFormats.jl package to be installed. The package uses <a href="https://github.com/Non-Contradiction/JuliaCall" class="external-link">JuliaCall</a> to interface with Julia from R.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The R package provides an interface similar to the Julia package, with functions that mirror the Julia API:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tanaylab.github.io/dafr/">dafr</a></span><span class="op">)</span></span>
<span><span class="co"># Setup connection to Julia</span></span>
<span><span class="fu"><a href="reference/setup_daf.html">setup_daf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a DAF object in memory</span></span>
<span><span class="va">daf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/memory_daf.html">memory_daf</a></span><span class="op">(</span><span class="st">"example"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add axes</span></span>
<span><span class="fu"><a href="reference/add_axis.html">add_axis</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"obs"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cell1"</span>, <span class="st">"cell2"</span>, <span class="st">"cell3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/add_axis.html">add_axis</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"var"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene1"</span>, <span class="st">"gene2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add vector data</span></span>
<span><span class="fu"><a href="reference/set_vector.html">set_vector</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"obs"</span>, <span class="st">"score"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add matrix data</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/set_matrix.html">set_matrix</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"obs"</span>, <span class="st">"var"</span>, <span class="st">"counts"</span>, <span class="va">mat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access data</span></span>
<span><span class="fu"><a href="reference/get_vector.html">get_vector</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"obs"</span>, <span class="st">"score"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1 0.5 0.9</span></span>
<span><span class="fu"><a href="reference/get_matrix.html">get_matrix</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"obs"</span>, <span class="st">"var"</span>, <span class="st">"counts"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       gene1 gene2</span></span>
<span><span class="co">#&gt; cell1     1     4</span></span>
<span><span class="co">#&gt; cell2     2     5</span></span>
<span><span class="co">#&gt; cell3     3     6</span></span>
<span></span>
<span><span class="co"># Get a dataframe view</span></span>
<span><span class="fu"><a href="reference/get_dataframe.html">get_dataframe</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"obs"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"score"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       score</span></span>
<span><span class="co">#&gt; cell1   0.1</span></span>
<span><span class="co">#&gt; cell2   0.5</span></span>
<span><span class="co">#&gt; cell3   0.9</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="querying-data">Querying Data<a class="anchor" aria-label="anchor" href="#querying-data"></a>
</h2>
<p>One of the powerful features of dafr is its query language. You can use queries to access and transform data flexibly. The package provides a convenient <code>[</code> operator for concise query syntax:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a sample dataset</span></span>
<span><span class="va">daf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/memory_daf.html">memory_daf</a></span><span class="op">(</span><span class="st">"query_examples"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/add_axis.html">add_axis</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"cell"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/add_axis.html">add_axis</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"gene"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/set_vector.html">set_vector</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"cell"</span>, <span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/set_vector.html">set_vector</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"cell"</span>, <span class="st">"type"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"B"</span>, <span class="st">"NK"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/set_scalar.html">set_scalar</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"version"</span>, <span class="st">"1.0"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/set_matrix.html">set_matrix</a></span><span class="op">(</span><span class="va">daf</span>, <span class="st">"cell"</span>, <span class="st">"gene"</span>, <span class="st">"counts"</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Basic queries using the [ operator</span></span>
<span><span class="co"># Get scalar values</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">": version"</span><span class="op">]</span> <span class="co"># Get a scalar</span></span>
<span><span class="co">#&gt; [1] "1.0"</span></span>
<span></span>
<span><span class="co"># Access axes and properties</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"? axes"</span><span class="op">]</span> <span class="co"># List all axes</span></span>
<span><span class="co">#&gt; [1] "gene" "cell"</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"/ cell ?"</span><span class="op">]</span> <span class="co"># List properties of the "cell" axis</span></span>
<span><span class="co">#&gt; [1] "type" "age"</span></span>
<span></span>
<span><span class="co"># Access vector data</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"/ cell : age"</span><span class="op">]</span> <span class="co"># Get the "age" vector for all cells</span></span>
<span><span class="co">#&gt; [1]  1  5 10</span></span>
<span></span>
<span><span class="co"># Access matrix data</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"/ cell / gene : counts"</span><span class="op">]</span> <span class="co"># Get the full counts matrix</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    4    7</span></span>
<span><span class="co">#&gt; [2,]    2    5    8</span></span>
<span><span class="co">#&gt; [3,]    3    6    9</span></span>
<span></span>
<span><span class="co"># Filter data</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"/ cell &amp; age &gt; 2 : type"</span><span class="op">]</span> <span class="co"># Get types of cells with age &gt; 2</span></span>
<span><span class="co">#&gt; [1] "B"  "NK"</span></span>
<span></span>
<span><span class="co"># Transform data</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"/ cell : age % Abs"</span><span class="op">]</span> <span class="co"># Get absolute values of ages</span></span>
<span><span class="co">#&gt; [1]  1  5 10</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"/ cell : age % Log base 2"</span><span class="op">]</span> <span class="co"># Get log2 of ages</span></span>
<span><span class="co">#&gt; [1] 0.000000 2.321928 3.321928</span></span>
<span></span>
<span><span class="co"># Aggregations</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"/ cell : age %&gt; Max"</span><span class="op">]</span> <span class="co"># Get maximum age</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="st">"/ cell : age %&gt; Mean"</span><span class="op">]</span> <span class="co"># Get mean age</span></span>
<span><span class="co">#&gt; [1] 5.333333</span></span>
<span></span>
<span><span class="co"># Complex operations can be built using the pipe operator or query functions</span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Axis.html">Axis</a></span><span class="op">(</span><span class="st">"cell"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/And.html">And</a></span><span class="op">(</span><span class="st">"age"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/IsGreater.html">IsGreater</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/Lookup.html">Lookup</a></span><span class="op">(</span><span class="st">"type"</span><span class="op">)</span></span>
<span><span class="va">daf</span><span class="op">[</span><span class="va">query</span><span class="op">]</span> <span class="co"># Get types of cells with age &gt; 2</span></span>
<span><span class="co">#&gt; [1] "B"  "NK"</span></span></code></pre></div>
<p>The query syntax follows a simple pattern: - <code>/ axis</code> selects an axis - <code>: property</code> retrieves a property - <code>% operation</code> applies an element-wise operation - <code>%&gt; reduction</code> applies a reduction operation - <code>&amp; property</code> filters by a property - <code>= value</code>, <code>&gt; value</code>, etc. apply comparison operations</p>
<p>See the Julia <a href="https://tanaylab.github.io/DataAxesFormats.jl/v0.1.2/queries.html" class="external-link">documentation</a> for more details about the query language.</p>
<div class="section level3">
<h3 id="important-note-about-data-copying">Important Note About Data Copying<a class="anchor" aria-label="anchor" href="#important-note-about-data-copying"></a>
</h3>
<p>Due to limitations in JuliaCall, data is copied between R and Julia during function calls. This means that operations involving large matrices or vectors will incur memory overhead. For large datasets, consider performing more operations directly on the Julia side to minimize data transfers.</p>
</div>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<p>The dafr package inherits the key features of DataAxesFormats.jl:</p>
<ul>
<li>Support for both in-memory and persistent data storage</li>
<li>Thread-safe implementation using read/write locks</li>
<li>Ability to import and export AnnData objects</li>
<li>Support for views and adapters</li>
<li>Chaining repositories for efficient reuse of data</li>
<li>Flexible data model based on axes, vectors, matrices, and scalar data</li>
<li>Explicit support for grouped axes</li>
<li>Simple query language for common operations</li>
<li>Control over data layout and support for both dense and sparse matrices</li>
</ul>
</div>
<div class="section level2">
<h2 id="status">Status<a class="anchor" aria-label="anchor" href="#status"></a>
</h2>
<p>This package is in early development. The API is subject to change based on user feedback. Comments, bug reports, and PRs are welcome!</p>
<div class="section level3">
<h3 id="future-plans">Future Plans<a class="anchor" aria-label="anchor" href="#future-plans"></a>
</h3>
<p>In future releases, we plan to implement a dplyr-like API for dafr to make it even more intuitive for R users. This will allow you to use familiar verbs like <code><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter()</a></code>, <code>select()</code>, <code>mutate()</code>, and <code>summarize()</code> with dafr objects, combining the power of the Julia implementation with the ergonomics of the tidyverse.</p>
</div>
</div>
<div class="section level2">
<h2 id="license-mit">License (MIT)<a class="anchor" aria-label="anchor" href="#license-mit"></a>
</h2>
<p>Copyright © 2024 Weizmann Institute of Science</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tanaylab/dafr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tanaylab/dafr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing dafr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Aviezer Lifshitz <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8458-9507" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Oren Ben-Kiki <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tanaylab/dafr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tanaylab/dafr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aviezer Lifshitz, Oren Ben-Kiki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
